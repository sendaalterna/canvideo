// ken burns 
// options.paths=[{ from:[X,Y,Ratio], to:[X,Y,Ratio] },...] - transition description
// 					from - begin state, to - end state
// 					X,Y = 0..1 - relative position, 
//					Ratio>1 - degree of stretching, 
function ws_kenburns(d,t,z){function u(b){return h[b?Math.floor(Math.random()*(m?h.length:Math.min(5,h.length))):0]}function v(){g=f('<div style="width:100%;height:100%"></div>').css({"z-index":8,position:"absolute",left:0,top:0}).appendTo(A)}function w(b,c,d){var a={width:100*b[2]+"%"};a[c?"right":"left"]=-100*(b[2]-1)*(c?1-b[0]:b[0])+"%";a[d?"bottom":"top"]=-100*(b[2]-1)*(d?1-b[1]:b[1])+"%";if(!m)for(var e in a)/\%/.test(a[e])&&(a[e]=(/right|left|width/.test(e)?k:l)*parseFloat(a[e])/100+"px");return a}
function x(b,c,h){var a=f(b),a={width:a.width(),height:a.height(),marginTop:a.css("marginTop"),marginLeft:a.css("marginLeft")};m&&(r&&r.stop(1),r=y);n&&n.remove();n=g;v();h&&(g.hide(),n.stop(!0,!0));if(m){var e,p,q;q=f('<canvas width="'+k+'" height="'+l+'"/>');q.css({position:"absolute",left:0,top:0}).css(a).appendTo(g);e=q.get(0).getContext("2d");p=q.clone().appendTo(g).get(0).getContext("2d");y=wowAnimate(function(a){a=[c.from[0]*(1-a)+a*c.to[0],c.from[1]*(1-a)+a*c.to[1],c.from[2]*(1-a)+a*c.to[2]];
p.drawImage(b,-k*(a[2]-1)*a[0],-l*(a[2]-1)*a[1],k*a[2],l*a[2]);e.clearRect(0,0,k,l);a=e;e=p;p=a},0,1,d.duration+2*d.delay)}else k=a.width,l=a.height,f('<img src="'+b.src+'"/>').css({position:"absolute",left:"auto",right:"auto",top:"auto",bottom:"auto"}).appendTo(g).css(w(c.from,.5<c.from[0],.5<c.from[1])).animate(w(c.to,.5<c.from[0],.5<c.from[1]),{easing:"linear",queue:!1,duration:1.5*d.duration+d.delay});h&&g.fadeIn(d.duration)}var f=jQuery,B=f(this),m=document.createElement("canvas").getContext,
A=f("<div>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}).addClass("ws_effect ws_kenburns").appendTo(z),h=d.paths||[{from:[0,0,1],to:[0,0,1.2]},{from:[0,0,1.2],to:[0,0,1]},{from:[1,0,1],to:[1,0,1.2]},{from:[0,1,1.2],to:[0,1,1]},{from:[1,1,1],to:[1,1,1.2]},{from:[.5,1,1],to:[.5,1,1.3]},{from:[1,.5,1.2],to:[1,.5,1]},{from:[1,.5,1],to:[1,.5,1.2]},{from:[0,.5,1.2],to:[0,.5,1]},{from:[1,.5,1.2],to:[1,.5,1]},{from:[.5,.5,1],to:[.5,.5,1.2]},{from:[.5,.5,1.3],to:[.5,
.5,1]},{from:[.5,1,1],to:[.5,0,1.15]}],k=d.width,l=d.height,y,r,g,n;v();1==d.effect.length&&f(function(){t.each(function(b){f(this).css({visibility:"hidden"});b==d.startSlide&&x(this,u(b),0)})});this.go=function(b,c){setTimeout(function(){B.trigger("effectEnd")},d.duration);x(t.get(b),u(b),1)}};
// blast
// options.cols - columns count
// options.rows - rows count
// options.distance = 1 - flight distance
function ws_blast(k,n,x){function u(b,a,c,d){if(k.support.transform&&k.support.transition){if("number"===typeof a.left||"number"===typeof a.top)a.transform="translate3d("+("number"===typeof a.left?a.left:0)+"px,"+("number"===typeof a.top?a.top:0)+"px,0)";delete a.left;delete a.top;a.transition=c?"all "+c+"ms ease-in-out":"";b.css(a);if(d)b.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){d();b.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")})}else delete a.transfrom,
delete a.transition,c?b.animate(a,{queue:!1,duration:k.duration,complete:d?d:0}):b.stop(1).css(a)}function y(f){var a=Math.max((k.width||d.width())/(k.height||d.height())||3,3);l=l||Math.round(1>a?3:3*a);p=p||Math.round(1>a?3/a:3);for(a=0;a<l*p;a++)b([h[a]=document.createElement("div"),e[a]=document.createElement("div")]).css({position:"absolute",overflow:"hidden"}).appendTo(D).append(b("<img>").css({position:"absolute"}));e=b(e);h=b(h);q(e,f);q(h,f,!0);f={position:"absolute",top:0,left:0,width:"100%",
height:"100%",overflow:"hidden"};m.css(f).append(b("<img>").css(f))}function q(e,a,c,h,n,q){var v=d.width(),w=d.height(),m=b(window).scrollLeft(),z=b(window).scrollTop(),x=b(window).width(),y=b(window).height();b(e).each(function(e){var f=e%l,A=Math.floor(e/l);if(c){var r=B*v*(2*Math.random()-1)+v/2,t=B*w*(2*Math.random()-1)+w/2,g=d.offset();g.left+=r;g.top+=t;g.left<m&&(r-=g.left+m);g.top<z&&(t-=g.top+z);var C=m+x-g.left-v/l;0>C&&(r+=C);g=z+y-g.top-w/p;0>g&&(t+=g)}else r=v*f/l,t=w*A/p;b(this).find("img").css({left:-(v*
f/l)+a.marginLeft,top:-(w*A/p)+a.marginTop,width:a.width,height:a.height});f={left:r,top:t,width:v/l,height:w/p};n&&b.extend(f,n);h?u(b(this),f,k.duration,0===e&&q?q:0):u(b(this),f)})}var b=jQuery,E=b(this),F=x.find(".ws_list"),B=k.distance||1,d=b("<div>").addClass("ws_effect ws_blast"),m=b("<div>").addClass("ws_zoom").appendTo(d),D=b("<div>").addClass("ws_parts").appendTo(d);x.css({overflow:"visible"}).append(d);d.css({position:"absolute",left:0,top:0,width:"100%",height:"100%","z-index":8});var l=
k.cols,p=k.rows,e=[],h=[];this.go=function(f,a){var c=b(n[a]),c={width:c.width(),height:c.height(),marginTop:parseFloat(c.css("marginTop")),marginLeft:parseFloat(c.css("marginLeft"))};e.length||y(c);e.find("img").attr("src",n.get(a).src);u(e,{opacity:1,zIndex:3});h.find("img").attr("src",n.get(f).src);u(h,{opacity:0,zIndex:2});m.find("img").attr("src",n.get(a).src);u(m.find("img"),{transform:"scale(1)"});d.show();F.hide();q(h,c,!1,!0,{opacity:1});q(e,c,!0,!0,{opacity:0},function(){E.trigger("effectEnd");
d.hide()});u(m.find("img"),{transform:"scale(2)"},k.duration,0);c=h;h=e;e=c}};
